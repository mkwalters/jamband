(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{134:function(e,t,n){},168:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),s=n(14),r=n.n(s),i=(n(134),n(25)),o=n.n(i),l=n(36),j=n(11),u=n(20),d=n(16),b=n(2),h=n(94),p=n(95),O=n(120),x=n(118),f=function(e){Object(O.a)(n,e);var t=Object(x.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return Object(b.jsx)("div",{className:"App",children:Object(b.jsx)("h1",{children:"info"})})}}]),n}(c.Component),m=n(209),g=n(211),y=n(206),v=Object(y.a)({root:{minWidth:700,margin:"20px",backgroundColor:"#FFFDD0",display:"flex"},title:{fontSize:18},author:{fontSize:13},tree:{}}),k=function(){var e=v(),t={display:"block",marginTop:"10px",marginBottom:"10px"};return Object(b.jsx)("main",{class:"container",children:Object(b.jsx)("article",{class:"grid",children:Object(b.jsx)(m.a,{className:e.root,children:Object(b.jsx)(g.a,{children:Object(b.jsxs)("div",{children:[Object(b.jsx)("hgroup",{children:Object(b.jsx)("h1",{children:"Sign up"})}),Object(b.jsxs)("form",{action:"/users",method:"post",children:[Object(b.jsx)("input",{style:t,type:"text",name:"username",placeholder:"Username"}),Object(b.jsx)("input",{style:t,type:"password",name:"password",placeholder:"Password"}),Object(b.jsx)("button",{type:"submit",class:"contrast",children:"Sign up"})]})]})})})})})},_=n(212),S=Object(y.a)({root:{minWidth:700,margin:"20px",backgroundColor:"#FFFDD0",display:"flex"},title:{fontSize:18},author:{fontSize:13},tree:{}}),C=function(){var e=S(),t=Object(c.useState)(""),n=Object(j.a)(t,2),a=(n[0],n[1],Object(c.useState)("")),s=Object(j.a)(a,2);s[0],s[1];return Object(b.jsx)("main",{class:"container",children:Object(b.jsx)("article",{class:"grid",children:Object(b.jsxs)(m.a,{className:e.root,children:[Object(b.jsxs)(g.a,{children:[Object(b.jsxs)("div",{children:[Object(b.jsx)("hgroup",{children:Object(b.jsx)("h1",{children:"Log in"})}),Object(b.jsxs)("form",{action:"/login/password",method:"post",children:[Object(b.jsx)("input",{style:{display:"block"},type:"text",name:"username",placeholder:"Username"}),Object(b.jsx)("input",{style:{display:"block",marginTop:"10px",marginBottom:"10px"},type:"password",name:"password",placeholder:"Password"}),Object(b.jsx)("button",{style:{display:"block",marginTop:"10px",marginBottom:"10px"},type:"submit",class:"contrast",children:"Sign in"})]})]}),Object(b.jsx)("div",{children:Object(b.jsx)(u.b,{className:e.root,to:"/signup",children:"Create an account"})})]}),Object(b.jsx)(_.a,{})]})})})},N=n(119),w=n(39),F=Object(c.createContext)(null),P=n(51),D=(n(84),n(75),n(215)),B=n(213),U=n(111),T=n.n(U),E=n(113),I=n.n(E),z=n(110),L=n.n(z),R=n(112),A=n.n(R),W=n(222),J=n(221),G=n(56);function H(e){return Object(b.jsx)(J.a,Object(w.a)({elevation:6,variant:"filled"},e))}var M=Object(y.a)({root:{minWidth:700,marginTop:"12px",marginBottom:"12px",backgroundColor:"#FFFDD0"},bullet:{display:"inline-block",margin:"0 2px",transform:"scale(0.8)"},title:{fontSize:18},author:{fontSize:13},alert:{width:"100%","& > * + *":{marginTop:"10px"}}}),Y=function(){var e=M(),t=Object(c.useContext)(F),n=t.user,s=t.setUser,r=Object(c.useState)([]),i=Object(j.a)(r,2),d=i[0],h=i[1],p=Object(c.useState)(-1),O=Object(j.a)(p,2),x=O[0],f=O[1],y=a.a.useState(!1),v=Object(j.a)(y,2),k=v[0],S=v[1],C=function(e,t){"clickaway"!==t&&S(!1)},w=Object(c.useRef)([]),U=function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:fetch("/getUser").then((function(e){e.json().then((function(e){s(e)}))}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){s(U()),fetch("/songs").then((function(e){e.json().then((function(e){h(e.data)}))}))}),[]);var E=function(e,t){0!==G.keys(n).length?fetch("/votes",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({songId:e,liked:t,userId:n.user_id})}).then((function(e){e.json().then((function(e){d.forEach((function(t,n){if(e.songId===t.song_id){var c=Object(N.a)(d);console.log(e),c[n].total_votes=Number.parseInt(c[n].total_votes),!1===t.liked_by_current_user&&(e.liked?c[n].total_votes+=2:c[n].total_votes+=1),null===t.liked_by_current_user&&(e.liked?c[n].total_votes+=1:c[n].total_votes-=1),!0===t.liked_by_current_user&&(null===e.liked?c[n].total_votes-=1:c[n].total_votes-=2),c[n].liked_by_current_user=e.liked,h(c)}}))}))})):S(!0)};return Object(b.jsx)("div",{className:"App",children:Object(b.jsxs)("div",{children:[Object(b.jsx)(W.a,{open:k,autoHideDuration:6e3,onClose:C,children:Object(b.jsx)(H,{onClose:C,severity:"warning",children:"Please log in to vote"})}),d.map((function(t,n){return Object(b.jsx)("span",{style:{display:"flex",justifyContent:"center"},children:Object(b.jsxs)(m.a,{className:t.song_id===x?"card-selector":e.root,children:[Object(b.jsxs)(g.a,{children:[Object(b.jsx)(u.b,{to:"/song/"+t.song_id.toString(),children:Object(b.jsx)(D.a,{className:e.title,color:"textPrimary",gutterBottom:!0,style:{display:"inline"},children:t.name})}),Object(b.jsx)(D.a,{className:e.author,color:"textPrimary",gutterBottom:!0,style:{display:"inline"},children:" by "+t.username}),Object(b.jsx)(P.a,{src:t.s3key,onPlay:function(e){var n;n=t.song_id,console.log(w.current[0].id),console.log(n),w.current.forEach((function(e){e.id!==n&&e.player&&e.player.audio.current.pause()})),f(t.song_id)},style:{opacity:"0.5"},id:t.song_id,ref:function(e){return w.current.push({id:t.song_id,player:e})}})]}),Object(b.jsxs)(_.a,{children:[Object(b.jsx)("p",{style:{margin:"0px"},children:t.total_votes}),Object(b.jsx)(B.a,{onClick:function(){E(t.song_id,!0)},children:t.liked_by_current_user?Object(b.jsx)(L.a,{}):Object(b.jsx)(T.a,{})}),Object(b.jsx)(B.a,{onClick:function(){E(t.song_id,!1)},children:1!=t.liked_by_current_user&&void 0!=t.liked_by_current_user?Object(b.jsx)(A.a,{}):Object(b.jsx)(I.a,{})})]})]})})}))]})})},q=n(216),K=function(e){var t=e.msg;return Object(b.jsxs)("div",{className:"alert alert-info alert-dismissible fade show",role:"alert",children:[t,Object(b.jsx)("button",{type:"button",className:"close","data-dismiss":"alert","aria-label":"Close",children:Object(b.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]})},Q=function(e){var t=e.percentage;return Object(b.jsx)("div",{className:"progress",children:Object(b.jsxs)("div",{className:"progress-bar progress-bar-striped bg-success",role:"progressbar",style:{width:"".concat(t,"%")},children:[t,"%"]})})},V=n(114),X=n.n(V),Z=n(220),$=n(56);function ee(e){return Object(b.jsx)(J.a,Object(w.a)({elevation:6,variant:"filled"},e))}var te=Object(y.a)((function(e){return{root:{width:"100%","& > * + *":{marginTop:e.spacing(2)}}}})),ne=function(e){te();var t=a.a.useState(!1),n=Object(j.a)(t,2),s=n[0],r=n[1],i=Object(c.useState)(""),u=Object(j.a)(i,2),d=u[0],h=u[1],p=Object(c.useState)(""),O=Object(j.a)(p,2),x=(O[0],O[1]),f=Object(c.useState)({}),m=Object(j.a)(f,2),g=m[0],y=m[1],v=Object(c.useState)(""),k=Object(j.a)(v,2),_=k[0],S=k[1],C=Object(c.useState)(0),N=Object(j.a)(C,2),w=N[0],F=N[1],P=Object(c.useState)(""),D=Object(j.a)(P,2),B=D[0],U=D[1],T=function(e,t){"clickaway"!==t&&r(!1)},E=function(){var t=Object(l.a)(o.a.mark((function t(n){var c,a,s,i,l;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==$.keys(e.user).length&&null!=e.user){t.next=3;break}return r(!0),t.abrupt("return");case 3:return n.preventDefault(),(c=new FormData).append("file",d),c.append("previousPath",e.previousPath),c.append("songName",B),c.append("authorId",e.user.user_id),c.append("original",e.original),t.prev=10,t.next=13,X.a.post("/aws/upload",c,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(e){F(parseInt(Math.round(100*e.loaded/e.total)))}});case 13:a=t.sent,setTimeout((function(){return F(0)}),1e4),s=a.data,i=s.fileName,l=s.filePath,y({fileName:i,filePath:l}),S("File Uploaded"),t.next=24;break;case 20:t.prev=20,t.t0=t.catch(10),500===t.t0.response.status?S("There was a problem with the server"):S(t.t0.response.data.msg),F(0);case 24:case"end":return t.stop()}}),t,null,[[10,20]])})));return function(e){return t.apply(this,arguments)}}();return Object(b.jsxs)(c.Fragment,{children:[_?Object(b.jsx)(K,{msg:_}):null,Object(b.jsx)(W.a,{open:s,autoHideDuration:6e3,onClose:T,children:Object(b.jsx)(ee,{onClose:T,severity:"warning",children:"Must be logged in to upload files"})}),Object(b.jsx)("form",{onSubmit:E,children:Object(b.jsxs)("div",{className:"custom-file mb-4",children:[Object(b.jsx)(Z.a,{value:B,onChange:function(e){U(e.target.value)},id:"standard-basic",label:"Song name"}),Object(b.jsx)("input",{type:"file",className:"custom-file-input",id:"customFile",onChange:function(e){h(e.target.files[0]),x(e.target.files[0].name)},style:{display:"block"}}),Object(b.jsx)(Q,{percentage:w}),Object(b.jsx)("input",{type:"submit",value:"Upload",className:"btn btn-primary btn-block mt-4"})]})}),g?Object(b.jsx)("div",{className:"row mt-5",children:Object(b.jsxs)("div",{className:"col-md-6 m-auto",children:[Object(b.jsx)("h3",{className:"text-center",children:g.fileName}),Object(b.jsx)("img",{style:{width:"100%"},src:g.filePath,alt:""})]})}):null]})},ce=n(223),ae=n(217),se=n(117),re=n.n(se),ie=n(116),oe=n.n(ie),le=n(115),je=n.n(le),ue=n(56);function de(e){return Object(b.jsx)(J.a,Object(w.a)({elevation:6,variant:"filled"},e))}var be=Object(y.a)({root:{minWidth:700,marginTop:"12px",marginBottom:"12px",marginLeft:"12px",marginRight:"12px",backgroundColor:"#FFFDD0"},bullet:{display:"inline-block",margin:"0 2px",transform:"scale(0.8)"},title:{fontSize:18},author:{fontSize:13},tree:{}}),he=function(){var e=be(),t=Object(c.useContext)(F),n=t.user,a=(t.setUser,[]),s=Object(c.useState)(!1),r=Object(j.a)(s,2),i=r[0],o=r[1],l=Object(d.f)().id,u=Object(c.useState)([]),h=Object(j.a)(u,2),p=h[0],O=h[1],x=Object(c.useState)(!1),f=Object(j.a)(x,2),y=f[0],v=f[1],k=Object(c.useState)([]),S=Object(j.a)(k,2),C=S[0],N=S[1],w=Object(c.useState)([]),U=Object(j.a)(w,2),T=U[0],E=U[1],I=Object(c.useState)(!1),z=Object(j.a)(I,2),L=z[0],R=z[1],A=function(e,t){"clickaway"!==t&&R(!1)},J=function(){R(!0)};Object(c.useEffect)((function(){console.log("mounted"),fetch("/songs/".concat(l)).then((function(e){e.json().then((function(e){console.log(e.data[0]),O(e.data[0]);var t=e.data[0].path.split(".")[0];console.log("original ancestor: ",t),fetch("/songs/getTree/".concat(t)).then((function(e){e.json().then((function(e){console.log(e.data),N(e.data),E(function(e){for(var t=[],n=0;n<e.length;n++)for(var c=e[n].path.split("."),s=t,r=0;r<c.length;r++){for(var i=c[r],o=s,l=0;l<s.length;l++)if(s[l].pathName==i){s=s[l].children;break}if(o==s){a.push(e[n].song_id);var j=s[l]={id:e[n].song_id,name:e[n].name,pathName:i,children:[]};s=j.children}}return t[0]}(e.data))}))}))}))}))}),[]);return Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{className:e.root,children:Object(b.jsx)(W.a,{open:L,autoHideDuration:6e3,onClose:A,children:Object(b.jsx)(de,{onClose:A,severity:"warning",children:"Please log in to upload"})})}),Object(b.jsxs)(m.a,{className:i?"song-card-selector":e.root,children:[Object(b.jsxs)(g.a,{children:[Object(b.jsx)(D.a,{className:e.title,color:"textPrimary",gutterBottom:!0,style:{display:"inline"},children:p.name}),Object(b.jsx)(P.a,{src:p.s3key,onPlay:function(e){o(!0)},onPause:function(e){o(!1)},style:{opacity:"0.5"}}),Object(b.jsx)(B.a,{onClick:function(){!function(e,t){if(!e)throw new Error("Resource URL not provided! You need to provide one");fetch(e).then((function(e){return e.blob()})).then((function(e){var n=URL.createObjectURL(e),c=document.createElement("a");c.href=n,c.style="display: none",t&&t.length&&(c.download=t),document.body.appendChild(c),c.click()})).catch((function(){console.log("error")}))}(p.s3key,"".concat(p.name,".mp3"))},children:Object(b.jsx)(je.a,{})}),Object(b.jsx)(q.a,{variant:"outlined",onClick:function(){0!==ue.keys(n).length?v(!y):J()},children:"Upload a remix"}),y&&Object(b.jsx)(ne,{previousPath:p.path,user:n,original:!1})]}),Object(b.jsx)(_.a,{})]}),Object(b.jsxs)(m.a,{className:e.root,children:[Object(b.jsxs)(g.a,{children:[Object(b.jsx)("h3",{children:"Song ancestry "}),Object(b.jsx)(ae.a,{defaultCollapseIcon:Object(b.jsx)(oe.a,{}),defaultExpanded:a,defaultExpandIcon:Object(b.jsx)(re.a,{}),onNodeSelect:function(e,t){console.log(t),C.forEach((function(e){e.song_id===t&&O(e)}))},children:function e(t){return Object(b.jsx)(ce.a,{nodeId:t.id,label:t.name,onLabelClick:function(e){e.preventDefault()},children:Array.isArray(t.children)?t.children.map((function(t){return e(t)})):null},t.id)}(T)})]}),Object(b.jsx)(_.a,{})]})]})},pe=function(){var e=Object(c.useContext)(F).user,t=Object(c.useState)(""),n=Object(j.a)(t,2);n[0],n[1];return Object(b.jsxs)("div",{className:"App",children:[Object(b.jsx)("p",{children:JSON.stringify(e)}),Object(b.jsx)(ne,{previousPath:"",user:e,original:!0})]})},Oe=n(56),xe=Object(y.a)({root:{minWidth:700,marginTop:"12px",marginBottom:"12px",backgroundColor:"#FFFDD0"},bullet:{display:"inline-block",margin:"0 2px",transform:"scale(0.8)"},title:{fontSize:18},author:{fontSize:13},upload:{backgroundColor:"#FFFDD0",maxWidth:"200px"}});function fe(e){return Object(b.jsx)(J.a,Object(w.a)({elevation:6,variant:"filled"},e))}var me=function(){var e=xe(),t=Object(c.useContext)(F),n=t.user,s=t.setUser,r=Object(c.useState)([]),i=Object(j.a)(r,2),d=i[0],h=i[1],p=Object(c.useState)(!1),O=Object(j.a)(p,2),x=O[0],f=O[1],y=a.a.useState(!1),v=Object(j.a)(y,2),k=v[0],S=v[1],C=Object(c.useState)(-1),N=Object(j.a)(C,2),w=N[0],B=N[1],U=Object(c.useRef)([]),T=function(e,t){"clickaway"!==t&&S(!1)},E=function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:fetch("/getUser").then((function(e){e.json().then((function(e){s(e)}))}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){s(E()),fetch("/songs/backingtracks").then((function(e){e.json().then((function(e){h(e.data)}))}))}),[]);return Object(b.jsxs)("div",{className:"App",children:[Object(b.jsx)("div",{className:e.root,children:Object(b.jsx)(W.a,{open:k,autoHideDuration:6e3,onClose:T,children:Object(b.jsx)(fe,{onClose:T,severity:"warning",children:"Please log in to upload"})})}),Object(b.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:Object(b.jsx)(m.a,{className:e.upload,children:Object(b.jsxs)(g.a,{children:[Object(b.jsx)(q.a,{variant:"outlined",onClick:function(){0!==Oe.keys(n).length?f(!x):S(!0)},children:"Create new backing track"}),x&&Object(b.jsx)(ne,{previousPath:"",user:n,original:!0})]})})}),Object(b.jsx)("div",{children:d.map((function(t,n){return Object(b.jsx)("span",{style:{display:"flex",justifyContent:"center"},children:Object(b.jsxs)(m.a,{className:t.song_id===w?"card-selector":e.root,children:[Object(b.jsxs)(g.a,{children:[Object(b.jsx)(u.b,{to:"/song/"+t.song_id.toString(),children:Object(b.jsx)(D.a,{className:e.title,color:"textPrimary",gutterBottom:!0,style:{display:"inline"},children:t.name})}),Object(b.jsx)(D.a,{className:e.author,color:"textPrimary",gutterBottom:!0,style:{display:"inline"},children:" by "+t.username}),Object(b.jsx)(P.a,{src:t.s3key,onPlay:function(e){var n;n=t.song_id,console.log(U.current[0].id),console.log(n),U.current.forEach((function(e){e.id!==n&&e.player&&e.player.audio.current.pause()})),B(t.song_id)},ref:function(e){return U.current.push({id:t.song_id,player:e})},style:{opacity:"0.5"}})]}),Object(b.jsx)(_.a,{})]})})}))})]})},ge=n(218),ye=n(219),ve=n(56),ke=Object(y.a)((function(e){return{root:{flexGrow:1,color:"#FFFDD0"},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1},username:{marginRight:e.spacing(2),color:"black"}}})),_e=function(){var e=ke(),t=Object(c.useContext)(F),n=t.user,a=t.setUser;return Object(b.jsx)("div",{className:e.root,children:Object(b.jsx)(ge.a,{position:"static",style:{backgroundColor:"#FFFDD0"},children:Object(b.jsxs)(ye.a,{children:[Object(b.jsx)(D.a,{variant:"h6",className:e.menuButton,children:Object(b.jsx)(u.b,{to:"/",children:"Jamband"})}),Object(b.jsx)(q.a,{variant:"outlined",component:u.b,to:"/backingtracks",className:e.menuButton,children:"Backing Tracks"}),Object(b.jsx)(D.a,{variant:"h6",className:e.title}),0===ve.keys(n).length&&Object(b.jsxs)("div",{children:[Object(b.jsx)(q.a,{variant:"outlined",component:u.b,to:"/login",children:"Log in"}),Object(b.jsx)(q.a,{variant:"outlined",component:u.b,to:"/signup",children:"Sign up"})]}),Object(b.jsx)(D.a,{variant:"h6",className:e.username,children:ve.keys(n).length>0&&n.username}),ve.keys(n).length>0&&Object(b.jsx)(q.a,{variant:"outlined",component:u.b,onClick:function(){fetch("/logout"),a({})},children:"Logout"})]})})})};Object(y.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}}));function Se(){var e=Object(c.useState)(null),t=Object(j.a)(e,2),n=t[0],a=t[1],s=function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:fetch("/getUser").then((function(e){e.json().then((function(e){a(e)}))}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){a(s())}),[]),Object(b.jsx)(u.a,{children:Object(b.jsx)("div",{children:Object(b.jsxs)(F.Provider,{value:{user:n,setUser:a},children:[Object(b.jsx)(_e,{}),Object(b.jsxs)(d.c,{children:[Object(b.jsx)(d.a,{path:"/info",children:Object(b.jsx)(f,{})}),Object(b.jsx)(d.a,{path:"/signup",children:Object(b.jsx)(k,{})}),Object(b.jsx)(d.a,{path:"/login",children:Object(b.jsx)(C,{})}),Object(b.jsx)(d.a,{path:"/create",children:Object(b.jsx)(pe,{})}),Object(b.jsx)(d.a,{path:"/song/:id",children:Object(b.jsx)(he,{})}),Object(b.jsx)(d.a,{path:"/backingtracks",children:Object(b.jsx)(me,{})}),Object(b.jsx)(d.a,{path:"/",children:Object(b.jsx)(Y,{})})]})]})})})}var Ce=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,224)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,s=t.getLCP,r=t.getTTFB;n(e),c(e),a(e),s(e),r(e)}))};r.a.render(Object(b.jsx)(a.a.StrictMode,{children:Object(b.jsx)(Se,{})}),document.getElementById("root")),Ce()},75:function(e,t,n){}},[[168,1,2]]]);
//# sourceMappingURL=main.8bd7ea80.chunk.js.map